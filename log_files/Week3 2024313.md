# Week3 2024/3/13

## 1. 模拟实验

![image-20240313140711066](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240313140711066.png)



![image-20240313140724319](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240313140724319.png)

![image-20240313140739948](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20240313140739948.png)

1. 生成2000个数据点：ARIMA，基础预测分布假设为正态分布

2. 两种情况：独立预测、联合预测

   1. 独立预测

      |      | Base     | BottomUp | JPP      | OLS      | WLS      | MinTSam  | MinTShr  |
      | ---- | -------- | -------- | -------- | -------- | -------- | -------- | -------- |
      | 1    | 56.20084 | 66.26784 | 169.6121 | 42.66999 | 46.45658 | 46.55699 | 41.34433 |
      | 2    | 53.68573 | 64.13537 | 167.2707 | 39.47959 | 43.30442 | 45.72146 | 39.97087 |
      | 3    | 52.07585 | 65.35728 | 167.9176 | 37.7087  | 40.97728 | 42.40264 | 37.02596 |
      | 4    | 54.61641 | 70.63054 | 169.121  | 38.83741 | 42.57603 | 47.04594 | 40.77153 |
      | 5    | 50.98955 | 63.62787 | 162.2202 | 39.03381 | 42.429   | 44.24454 | 39.43321 |
      | 6    | 52.11614 | 68.33943 | 165.7888 | 37.35578 | 41.16198 | 42.1126  | 36.18619 |
      | 7    | 56.01007 | 64.91561 | 172.099  | 44.23887 | 46.64308 | 51.64033 | 44.65966 |
      | 8    | 54.75393 | 71.51158 | 168.2586 | 40.30305 | 44.61563 | 46.7056  | 39.79782 |
      | 9    | 55.64322 | 73.77787 | 168.005  | 41.15277 | 46.35791 | 47.56964 | 41.54648 |
      | 10   | 59.66721 | 72.58499 | 177.0923 | 45.48601 | 48.61837 | 49.15131 | 43.86218 |

   2. 联合预测

      |      | Base     | BottomUp | JPP      | OLS      | WLS      | MinTSam  | MinTShr  |
      | ---- | -------- | -------- | -------- | -------- | -------- | -------- | -------- |
      | 1    | 8.583999 | 8.997597 | 23.17965 | 8.083885 | 8.299218 | 6.790594 | 6.666346 |
      | 2    | 8.799308 | 9.518714 | 23.3823  | 8.559789 | 8.759152 | 7.929732 | 7.968844 |
      | 3    | 9.695897 | 10.41722 | 24.81176 | 9.196529 | 9.396926 | 8.146344 | 8.316268 |
      | 4    | 9.516133 | 10.19259 | 24.40697 | 8.868876 | 9.146446 | 8.532375 | 8.644004 |
      | 5    | 9.332068 | 9.458344 | 22.41332 | 9.11312  | 9.339203 | 9.395234 | 9.292642 |
      | 6    | 13.51932 | 18.58743 | 27.69751 | 11.67095 | 14.05642 | 7.306386 | 7.458369 |
      | 7    | 19.61654 | 27.3146  | 35.13598 | 18.59534 | 21.40875 | 12.23522 | 12.3505  |
      | 8    | 9.990625 | 14.1111  | 23.18005 | 8.833622 | 9.631112 | 7.514502 | 7.711016 |
      | 9    | 14.1163  | 25.5516  | 28.40806 | 11.53386 | 15.43423 | 6.514444 | 6.512657 |
      | 10   | 17.01481 | 24.92294 | 32.94676 | 15.51568 | 17.7809  | 10.44994 | 10.46287 |

## 2. 优化问题

1. 为每个时间t生成基础概率预测:
   $$
   \hat{f}_{t+1|t}
   $$

2. 从中抽样Q个，两次独立抽样:
   $$
   \hat{y}^q_{t+1|t},\hat{y^*}^q_{t+1|t}
   $$

3. 对样本进行调和后得到：
   $$
   \tilde{y}^q_{t+1|t},\tilde{y^*}^{q}_{t+1|t}
   $$

4. 优化建模

   目标函数：
   $$
   f=\sum^{T+R-1}_{t=T}ES(\tilde{f}_{t+1|t},y_{t+1})
   $$
   约束条件：

   1. 调和样本与基础样本的G矩阵
   2. 调和样本非负

## 3. 问题和下一周计划

问题：

1. 滚动预测生成基础概率预测
2. 训练集/测试集划分

下周计划：

1. 优化问题求解
2. DeepAR相关论文代码复现

## DeepAR

1. 使用相关时间序列的数据（其他家庭的能源消耗、对其他产品的需求）不仅可以在不过度拟合的情况下拟合更复杂（因此可能更准确）的模型，还可以减轻选择和准备协变量以及选择经典技术所需模型的人工和劳动密集步骤
2. 在实际的预测问题中，特别是在需求预测领域，人们经常面临高度块状或间歇性的数据，这些数据违反了许多经典技术的核心假设，如时间序列的高斯性、平稳性或同方差性。长期以来，人们一直认为这是一个重要问题。
3. 深度神经网络为这种管道提供了一种替代方案。这样的模型需要有限数量的标准化数据预处理，之后通过学习端到端模型来解决预测问题。特别是，数据处理被包括在模型中，并共同优化，以实现产生尽可能好的预测的目标。在实践中，深度学习预测管道几乎完全依赖于模型可以从数据中学习到的东西，而传统管道在很大程度上依赖于启发式方法，如专家设计的组件和手动协变量设计



## 模拟

1. 离散：VAR（1） 二项式实现  合理系数取值保证平稳 相关为正
2. ARIMA，p q随机 参数空间保证平稳+可逆 相关为正